---
import DefaultLayout from "../layouts/DefaultLayout.astro"
import Component from "../components/Component.jsx"

const key = "BZX4R4Dr8Y6rnegRb9YaPwtt"
const cacheBuster = new Date().getMilliseconds()
const { story } = await fetch(`https://api.storyblok.com/v2/cdn/stories/home?token=${key}&cv=${cacheBuster}`)
	.then(response => response.json());
---
<DefaultLayout
  title={story.content.SEO.title || story.name}
  description={story.content.SEO.description || ""}
>
  {story.content.body.map(child => {
    return <Component blok={child}/>
  })}
  {JSON.stringify(story.content.body).includes(`"component":"Tabs"`) === true &&
    <script src="/js/tabs.js"></script>
  }
</DefaultLayout>